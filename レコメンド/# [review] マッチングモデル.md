# 推薦モデル  
## 推薦  
ユーザーに対して合うようなコンテンツをすすめること

## 推薦アルゴリズム  
大きく分けて以下の二つのアルゴリズムが存在.   
- 内容ベースフィルタリング  
  ユーザー個人のプロファイルとコンテンツの一致度合を見て推薦する。(他のユーザーのデータは使わない。)  
  例
  - 登録時に好きなジャンルを登録してもらい、そのジャンルの漫画を推薦する。
  - これまでの当該ユーザーの履歴から、少女漫画の購入が多いので、少女漫画を推薦する。  
- 協調フィルタリング  
  ユーザー個人のプロファイルと、そのユーザーに近い傾向のユーザーの購入動向を見て、  
  推薦を行う。  
    - アニメAを購入する人はアニメBも購入する傾向にある。  
    これをもとに、アニメAを購入したユーザーにアニメBをレコメンドする。   
今回は協調フィルタリングを対象にする。  

## 推薦モデルの発展  
  - アソシエーションルール  
  - 行列分解
  - 深層学習  
  
最近では深層学習ベースの手法が使われることもある。  
- facebook(2020) https://arxiv.org/pdf/2006.11632.pdf
- googleの検索(2020) https://arxiv.org/abs/2008.13535
- youtube(2020) https://research.google/pubs/pub48840/  

## 深層学習ベースの手法  
一例としてベクトル探索を用いる方法を紹介する。  
- 概要  
  - ユーザーとコンテンツを同じ空間にプロットする。（これをEmbeddingと呼ぶ.)     
  コンテンツ、ユーザーをinputしたときにN次元(この場合は2次元)のベクトルがoutputされる  
  機械学習モデルを考える。  
  - この時、下図のように、類似性の高いユーザーとコンテンツが近くに配置されるようにする。  

![embedding](https://user-images.githubusercontent.com/54636129/197065402-566a49d6-957c-48b9-a2c3-53390709b273.png)   
実際に推薦を行う際にはユーザーのデモグラ情報を機械学習モデルに入力し、ユーザーベクトルを取得  
これに一番近いアイテムを推薦する。  　　
![推薦](https://user-images.githubusercontent.com/54636129/197066025-2b9ecba4-f45b-4746-b71d-f692a9805dc4.png)  

- どのようにEmbeddingを学習するのか  
two tower modelsという二つのニューラルネットを同時に学習するモデルを使う  
ユーザーのデモグラ情報とそのユーザーが実際に買ったアイテム情報を入力とし  
それぞれの出力ベクトルuとvの距離に応じて大きくなるLossが最小になるようになるように学習を行う。  
学習データ内のユーザーと商品の組み合わせが遠くにあると損失が大きくなるので  
ユーザーと商品のペアが近くなるように二つのニューラルネットの学習が進む。
![image](https://user-images.githubusercontent.com/54636129/192722504-4be52269-2eb3-4fd8-b4da-2a57362bd22f.png)  
  
- 実際のマッチングの課題  
「ユーザーと一番距離が近いアイテムを探す」の段階で計算量が膨大になり、時間がかかる。  
（ユーザーと全アイテムの距離を計算する必要があるため。）  
  
これを高速で行えるのがvertex AIマッチングエンジン。  
各アイテムを代表するを決めることで、検索を高速に  
代表点の決定に機械学習が使われている。   
![無題の図形描画 (3)](https://user-images.githubusercontent.com/54636129/197068028-970133f5-9769-4e8c-9bf6-daedbf9f912b.png)
